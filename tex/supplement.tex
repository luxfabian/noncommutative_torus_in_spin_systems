\documentclass[
    aps,
    prb,
    twocolumn,
    floatfix,
    superscriptaddress,
	10pt
]{revtex4-2}

%-- Font  -------------------------------------------

\usepackage[utf8]{inputenc}
\usepackage{times}
\usepackage{bm}

%-- Format  -----------------------------------------

\usepackage[breaklinks, unicode]{hyperref}
\usepackage{url}

%-- Science  ----------------------------------------

\usepackage{siunitx}
\usepackage[version=4]{mhchem}

%-- Math  -------------------------------------------

\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{braket}

\usepackage{amstext} 
\usepackage{booktabs}
\newcolumntype{L}{>{$}l<{$}} % math-mode version of "l" column type

%-- Graphics  ---------------------------------------

\usepackage{tikz-cd}
\usepackage{xcolor}
\usepackage{graphicx}

%-- User  -------------------------------------------

\input{commands}


%====================================================
\begin{document}
%====================================================

\renewcommand{\arraystretch}{1.2}
\setcounter{secnumdepth}{2} 
\hbadness=2000 

%-- Header  -----------------------------------------

\title{
	\texorpdfstring{
    Supplemental Material: Unified  topological characterization of electronic states in spin textures \\ from noncommutative K-theory
	}
	{
	Supplemental Material: Unified  topological characterization of electronic states in spin textures from noncommutative K-theory
	}
}

\author{Fabian R. Lux}
    \email{fabian.lux@yu.edu}
    \affiliation{\mainz}
	\affiliation{\nyc}

\author{Sumit Ghosh}
   \affiliation{\pgi} 
   
\author{Pascal Prass}
    \affiliation{\mainz}
    
\author{Emil Prodan}
    \affiliation{\nyc}
    
\author{Yuriy Mokrousov}
    \affiliation{\pgi}
    \affiliation{\mainz}

\date{\today}


\begin{abstract}
	The Supplemental Material provides details on the derivations from the manuscript. 
	In order to make the discussions in the Supplemental Material more or less self-contained, table \ref{tab:notation} summarizes the central definitions from the manuscript.
	Additionally, a brief introduction to K-theory is given in the context of this work.
\end{abstract}


\maketitle

\onecolumngrid


\tableofcontents

\clearpage


\begin{table*}[t!]
	\centering
	\caption{{\bf Summary of the notation in the manuscript.} 
	The following table lists important symbols and notation which is used throughout the manuscript and gives a brief explanation.
	}
	\label{tab:notation}\vspace{0.2cm}
	\begin{tabular}{c|p{15cm}}
	 Symbol  & Explanation \\ \toprule
	$t$      & Hopping parameter \\
	$\xc$    & Exchange-correlation energy \\
	$d$      & Dimensionality of the lattice \\
	$N$      & Number of sites in the lattice; Thermodynamic limit: $N\to\infty$ \\
	$\vec{a}_i$ & Bravais lattice vectors \\
	$\vec{b}_j$ & Reciprocal lattice vectors; $\vec{a}_i \cdot \vec{b}_j = 2\pi \delta_{ij}$ \\
	$\vec{x}_{\vec{k}}$ &  Real-space coordinates; $\vec{x}_{\vec{k}} = \sum_{i=1}^3 k_i \vec{a}_i $ \\
	$\vec{q}_i$ & The $i$-th $\vec{q}$-vector of the multi-$\vec{q}$ texture; 
	$\vec{q}_i = \sum_{j=1}^d \theta_{ij} \vec{b}_j$ \\
	$ \boldsymbol{\theta}_i$ & $i$-th column vector in $\theta_{ij}$;  $(\boldsymbol{\theta}_i)_j = \theta_{ij}$ \\
	$ r $  & Number of distinct $\vec{q}$-vectors \\
	$ T^r $ & The $r$-dimensional torus \\ 
	$ \omega_i (\vec{x}_\vec{k}) $ & Phase with values in $T^1$, associated with $\vec{q}_i$; $ \omega_i (\vec{x}_\vec{k}) =  (\vec{x}_\vec{k}  \cdot \vec{q}_i/ (2\pi) + \varphi_i) \mod 1 $ \\
	$\boldsymbol{\omega}$ & The collection of all $\omega_i \in T^1$ into a vector $\boldsymbol{\omega}\in T^r$ \\ 
	$\ket{\vec{k}} $ & Position ket corresponding to the atomic site at location $\vec{x}_\vec{k}$ \\
	$ \ket{\sigma} $ & Spin ket labelled by the eigenstates of Pauli matrix $\sigma_z$ \\
	$ \ket{\vec{k}, \sigma} $ & Tensor product state $ \ket{\vec{k}, \sigma} = \ket{\vec{k}} \otimes \ket{\sigma}$ \\
	$\hat{T}_{\vec{m}}$ & Lattice translation operator acting on kets with $\vec{m}\in \mathbb{Z}^d$; $  \hat{T}_\vec{m} \ket{\vec{k}, \sigma}  =  \ket{\vec{k}+ \vec{m}, \sigma}$ \\
	$\hat{T}_{i}$ & Unit lattice translation in the $i$-th direction\\
	$\tau_{\vec{m}}$ & Action of the translation group $\mathbb{Z}^d \ni \vec{m} $ on the phases;  $  \tau_{\vec{m}}\omega_i (\vec{x}_\vec{k}) = ( \omega_i (\vec{x}_\vec{k} ) - ( \vec{m} \cdot \boldsymbol{\theta}_i \mod 1) ) \mod 1 $ \\
	$\tau_{i}$ & Unit lattice translation of the phases in the $i$-th direction\\
	$\boldsymbol{\phi} $ & The phase vector at one arbitrary, but fixed reference point $\vec{x}_0 \in \mathbb{R}^d$; $\boldsymbol{\phi} \equiv \boldsymbol{\omega}(\vec{x}_0) \in T^r$ \\
	$\Omega $ & Hull of the magnetic pattern;  $\Omega =  \lbrace \tau_{\vec{m}}\boldsymbol{\phi} ~|~ \vec{m} \in \mathbb{Z}^d \rbrace  \subset T^r $  \\
	$u_k$ & Fourier amplitude $u_k = e^{ 2 \pi i \phi_k}$; generator of periodic functions (functions on the $T^r$) \\
	$\Theta $ & Generalized flux matrix; $\Theta = ( (0, -\theta^T), (\theta,0))$ \\
	$\boldsymbol{\alpha}$ & Vector of generators; $\boldsymbol{\alpha}=(\tau_1, \ldots, \tau_d, u_1,\ldots u_r )$ \\
	$\mathcal{A}_\Theta $ & The universal $C^\ast$-algebra of the noncommutative torus; $\mathcal{A}_\Theta = \Braket{ \alpha_1, \cdots, \alpha_{r+d}
    |  \alpha_l \alpha_k = e^{ 2 \pi i \Theta_{lk}} \alpha_k  \alpha_l }$\\
	$d_{\mathrm{eff}} $ & Effective dimension; $d_{\mathrm{eff}} = r+d $ \\
	$P$ & Projection operator in $\mathcal{A}_\Theta$; $P^2 = P$ \\
	$[P]$ & Equivalence class of unitarily equivalent projection operators in $\mathcal{A}_\Theta$; \\
	$K_0(\mathcal{A}_\Theta) $ & The (Grothendieck) group of all $[P]$; $K_0(\mathcal{A}_\Theta)  = \mathbb{Z}^{2^{d_\mathrm{eff}-1}}$ \\
	$\mathcal{I}$ & Index set which labels the generators; $\mathcal{I}=\lbrace \tau_1 \cdots, \tau_d, u_1  \cdots, u_r \rbrace$ 
	\\
	$J$ & An even cardinality subset of $\mathcal{I}$; $ J \subseteq \mathcal{I} \colon |J|~\mathrm{even}$ \\
	$E_J$ & Generators of $K_0(\mathcal{A}_\Theta) $ \\ 
	$\Theta_{J\setminus J'}$ & Restriction of the flux matrix to the submatrix for the restricted index set $J \setminus J'$ \\
	$\mathrm{Ch}_J(g) $ &  $|J|/2$-th Chern number of the gap with label $g$ and w.r.t. to the indices $J$ \\
	$\mathrm{Pf}(A)$ &  The Pfaffian of a matrix $A$; For $A^T = -A\colon (\mathrm{Pf}(A))^2 = \det A$ \\
	$\mathrm{IDS}(g)$ & Integrated density of states within the gap $g$; $\mathrm{IDS}(g) = \lim\limits_{N\to\infty}  \frac{1}{N} \tr~P_{E<E_g}$, where $E_g$ is an energy in $g$ and $P_{E<E_g}$ projects onto states below $E_g$
\\ \bottomrule
	\end{tabular}\\
\end{table*}

\clearpage



\subsection{Bringing the Hamiltonian into its covariant form}


We begin by demonstrating how the Hamiltonian can indeed be written in the canonical form presented in the manuscript.
For the hopping term, one finds
\begin{align}
H_t &= t \sum_{\braket{\vec{k},\vec{l}} \in \mathbb{Z}^{2d}}\ket{\vec{k}}\bra{\vec{l}}
\notag \\
&= 
	t \sum_{\vec{k} \in \mathbb{Z}^{d}}  \sum_{l=1}^d
	\left( \ket{\vec{k}}\bra{\vec{k}+\vec{e}_l } + \ket{\vec{k}+\vec{e}_l}\bra{\vec{k} } \right)
\notag \\
&= 
	t \sum_{\vec{k} \in \mathbb{Z}^{d}} \sum_{l=1}^d
	(\hat{T}_l + \hat{T}_l^\dagger)\ket{\vec{k}}\bra{\vec{k} } 
\notag \\
&= 
 \sum_{l=1}^d
(\hat{T}_l+ \hat{T}_l^\dagger) \sum_{\vec{k} \in \mathbb{Z}^{d}} t \ket{\vec{k}}\bra{\vec{k} } 
\notag \\
&= t
\sum_{l=1}^d
(\hat{T}_l + \hat{T}_l^\dagger)  ,
\end{align}
where $\hat{T}_l$ is a unit-translation in the direction $\vec{e}_l \in \mathbb{Z}^d$.
It is therefore invariant under translations:  $\hat{T}_\vec{m} 
H_t
\hat{T}_\vec{m}^\dagger = H_t$. 
The exchange term is given by
\begin{align}
	H_\mathrm{xc} &=
	\xc\sum_{\vec{k} \in \mathbb{Z}^d}  (\hatn (\boldsymbol{\omega}(\vec{x}_\vec{k})) \cdot \bsigma) ~ \ket{\vec{k}}\bra{\vec{k}} .
\end{align}
It is not invariant under lattice translations, but transforms as
\begin{align}
	\hat{T}_\vec{m}
	H_\mathrm{xc}
	\hat{T}_\vec{m}^\dagger
	& = \xc\sum_{\vec{k} \in \mathbb{Z}^d}  (\hatn (\boldsymbol{\omega}(\vec{x}_\vec{k})) \cdot \bsigma) ~ \ket{\vec{k}+\vec{m}}\bra{\vec{k}+\vec{m}}
		\notag \\
	& = \xc\sum_{\vec{k} \in \mathbb{Z}^d}  (\hatn (\boldsymbol{\omega}(\vec{x}_{\vec{k}-\vec{m}})) \cdot \bsigma) ~ \ket{\vec{k}}\bra{\vec{k}}
	\notag \\
	& = \xc\sum_{\vec{k} \in \mathbb{Z}^d}  (\hatn (\tau_\vec{m} \boldsymbol{\omega}(\vec{x}_{\vec{k}})) \cdot \bsigma) ~ \ket{\vec{k}}\bra{\vec{k}} . 
\end{align} 
With the definition $\boldsymbol{\phi} = \boldsymbol{\omega}(\vec{x}_0)$, the exchange term can therefore also be written as 
\begin{align}
	H_\mathrm{xc}( \boldsymbol{\phi} ) &=
	\xc\sum_{\vec{k} \in \mathbb{Z}^d}  (\hatn ( \tau_\vec{-k}\boldsymbol{\phi}) \cdot \bsigma) ~ \ket{\vec{k}}\bra{\vec{k}} ,
	\notag \\ & =
	\xc\sum_{\vec{k} \in \mathbb{Z}^d}  (\hatn (\boldsymbol{\phi} + \theta \vec{k}) \cdot \bsigma) ~ \ket{\vec{k}}\bra{\vec{k}} 
\end{align}
and the translation of the Hamiltonian $H = H_t + H_\mathrm{xc}(\boldsymbol{\phi})$ can  be expressed in the compact, covariant form
\begin{align}
\hat{T}_\vec{m}	H( \boldsymbol{\phi} )\hat{T}_\vec{m}^\dagger
 = H( \tau_\vec{m}\boldsymbol{\phi} ) ,
\end{align}
or alternatively
\begin{align}
	\hat{T}_\vec{m}^\dagger	H( \boldsymbol{\phi} )\hat{T}_\vec{m}
	 = H( \boldsymbol{\phi} +  \theta\vec{m} ) .
	\end{align}
Combining the results above, the Hamiltonian can finally be cast into the form
\begin{equation}
	H =  \sum_{\vec{n} \in \mathbb{Z}^d} \hat{T}_\vec{n}  \sum_{\vec{m} \in \mathbb{Z}} h_\vec{n}(  \boldsymbol{\phi} + \theta \vec{m}  ) \ket{ \vec{m}} \bra{ \vec{m}} ,
\end{equation}
with the definition
\begin{equation}
	h_\vec{n}(  \boldsymbol{\phi} )
	\equiv
	\left\lbrace
	\begin{array}{ll}
		\xc (\hatn ( \boldsymbol{\phi}) \cdot \bsigma) , & \vec{n} = 0  \\
		t~\id_2, & \exists l \in \lbrace 1,\cdots,d \rbrace\colon \vec{n} = \vec{e}_l ~\text{or}~\vec{n} = -\vec{e}_l \\
		0, & \text{otherwise.}
		\end{array}
	\right.
\end{equation}

% Since we define $\vec{q}_i = \sum_{j=1}^d \theta_{ij} \vec{b}_j$ (with $\theta$ being a $r\times d$-dimensional matrix), one has
% \begin{align}
% 	\vec{x}_\vec{k} \cdot \vec{q}_l
% 	&= \Big( \sum_i  k_i \vec{a}_i\Big) \cdot \Big(\sum_{j=1}^d \theta_{lj} \vec{b}_j \Big)
% 	\notag \\
% 	&= 2 \pi  \sum_i k_i  \theta_{li}
% 	\notag \\
% 	& \equiv 2 \pi  \vec{k} \cdot \boldsymbol{\theta}_l,
% \end{align}
% where $\boldsymbol{\theta}_l$ is the $l$-th column vector of $\theta_{li}$.
% From this follows
% \begin{equation}
%  \frac{1}{( 2\pi) }	\vec{x}_{\vec{k} + \vec{m}} \cdot \vec{q}_l 
% 	= (\theta \vec{m})_l .
% \end{equation}


\subsection{Derivation of the torus commutation relation}

The covariant form of the Hamiltonian demonstrates that it fits into a generic form which combines the action of the translation operator with matrix-valued functions on the $r$-torus $T^r$. 
A continuous function $f\colon T^r \to \mathbb{C}$ can be decomposed into a Fourier series as
\begin{align}
	f( \boldsymbol{\phi} ) & = \sum_{\vec{n} }  f_{\vec{n} }~ e^{2 \pi i \boldsymbol{\phi} \cdot \vec{n} }
	\notag \\
	& = \sum_{\vec{n} }  f_{\vec{n} }~ e^{2 \pi i \phi_1 n_1 } \cdots e^{2 \pi i \phi_r n_r }
	\notag \\
	& = \sum_{\vec{n} }  f_{\vec{n} } ~( e^{2 \pi i \phi_1  } )^{n_1} \cdots ( e^{2 \pi i \phi_r  } )^{n_r} 
	\notag \\
	& \equiv \sum_{\vec{n} }  f_{\vec{n} } ~u_1^{n_1} \cdots u_r^{n_r} .
\end{align}
In other words, the algebra of continuous functions on the torus is generated by $u_k = e^{2 \pi i \phi_k  }$.
One can condense this result into the presentation 
\begin{equation}
	C(T^r) = \Braket{ u_1, \ldots, u_r ~|~ [u_i, u_j] = 0} .
\end{equation}
The commutation relation between the unit lattice translation $\tau_l$ and the Fourier factor $u_k$ can be derived as
\begin{align}
	\tau_l u_k &=
	\exp\lbrace 
	2 \pi i  (\tau_l \phi_k )
	\rbrace \tau_l
	\\ \notag 
	&=
	\exp\lbrace 
	2 \pi  i ( ( \phi_k - ( \vec{e}_l \cdot \boldsymbol{\theta}_k \mod 1) ) \mod 1 )
	\rbrace \tau_l
	\\ \notag 
	&=
	\exp\lbrace 
	2 \pi  i  ( \phi_k - ( \vec{e}_l \cdot \boldsymbol{\theta}_k \mod 1))
	\rbrace \tau_l
	\\ \notag  &= 
	\exp\lbrace 
	-2 \pi  i ( \vec{e}_l \cdot \boldsymbol{\theta}_k \mod 1)
	\rbrace u_k \tau_l
	\\ \notag  &= 
	\exp\lbrace 
	-2 \pi  i  (\vec{e}_l \cdot \boldsymbol{\theta}_k )
	\rbrace u_k \tau_l
	\\ \notag  &= 
	\exp\lbrace 
	-2 \pi  i  \theta_{kl} 
	\rbrace u_k \tau_l 
\end{align}
which gives the relation presented in the manuscript.




\subsection{A more precise description of the noncommutative torus}

{\it The following section is adapted from \cite{Liu2022}}. By defining $\boldsymbol{\alpha}=(\tau_1, \ldots, \tau_d, u_1,\ldots u_r )$, the commutation relations can be summarized to $\alpha_l \alpha_k = e^{2 \pi i \Theta_{lk}} \alpha_k  \alpha_l$, where
\begin{equation}
    \Theta = \begin{pmatrix}
    0 & -\theta^T \\
    \theta & 0
    \end{pmatrix} .
\end{equation}
The manuscript summarizes the observable algebra of a multi-$\vec{q}$ texture as the universal $C^\ast$-algebra given by the presentation
\begin{align}
    \mathcal{A}_\Theta &= \Braket{ \alpha_1, \cdots, \alpha_{\deff}
    |  \alpha_l \alpha_k = e^{ 2 \pi i \Theta_{lk}} \alpha_k  \alpha_l },
\end{align}
with $\deff = r+ d$.
$ \Theta_{lk}$ is considered as an antisymmetric  $\deff\times \deff$  matrix with entries from $\RM/\ZM$.
A generic element of the algebra can be presented in the form
\begin{align}
a & = \sum_{\vec{q} \in \ZM^{\deff}} a_{\vec{q}}
\, \alpha_{\vec{q}}, \quad \alpha_{\vec{q}} =\alpha_1^{q_1} \ldots\alpha_\deff^{q_\deff}, \quad a_{\vec{q}} \in \mathrm{Mat}_{2\times2} (\mathbb{C})
\notag \\
& = 	\sum_{\vec{q} \in \ZM^{d}} a( \boldsymbol{\phi}, \vec{q}) 
\, 
\alpha_1^{q_1} \ldots\alpha_d^{q_d},
\end{align}
where $ a(\boldsymbol{\phi},\vec{q}) $  is a continuous function $T^r \times \mathbb{Z}^d \to \mathrm{Mat}_{2\times 2}(\mathbb{C})$ with compact support.
The noncommutative torus accepts the trace
\begin{equation}
	\mathcal{T} \Big(
		\sum_{\vec{q} \in \ZM^{\deff}} a_{\vec{q}}
\, \alpha_{\vec{q}}
	\Big)
	= \tr~ a_{\vec
	0} .
\end{equation}
We define a representation of the noncommutative torus $\pi_{\boldsymbol{\phi}} \colon \mathcal{A}_\Theta \to \mathcal{B}(\ell^2(\mathbb{Z}^d \otimes \mathbb{C}^2))$ via the matrix elements
\begin{align}
	\braket{\vec{q}, \alpha
	|
	\pi_{\boldsymbol{\phi}} (a)
	| \vec{q}', \beta
	}
	=
	a_{\alpha \beta} ( \tau_{-\vec{q}} \boldsymbol{\phi}, \vec{q}'-\vec{q}) .
\end{align}
Constructed in this way, the representation fulfills the covariance condition
\begin{equation}
	\hat{T}_{\vec{m}}
	\pi_{\boldsymbol{\phi}} (a)
	\hat{T}_{\vec{m}}^\dagger
	= \pi_{\tau_{\vec{m}}\boldsymbol{\phi}} (a) ,
\end{equation}
which we previously confirmed to hold for the Hamiltonian.
Additionally, an involution is defined by
\begin{equation}
	a^\ast( \boldsymbol{\phi}, \vec{q})
	= a( \tau_{-\vec{q}} \boldsymbol{\phi}, -\vec{q})^\dagger .
\end{equation}
The $C^\ast$-algebra associated to $\mathcal{A}_{\Theta}$ is then given by the completion with respect to the norm 
\begin{equation}
	\| a \| = \sup\limits_{ \boldsymbol{\phi} \in T^r} \| \pi_{\boldsymbol{\phi}} a \| .
\end{equation}



% For the case when the entries of $\Theta$ are irrational and rationally independent, the noncommutative torus accepts a unique trace, which is given by
% \begin{equation}\label{Eq.NCTrace}
% \Tt \Big ( \sum_{\vec{q} \in \ZM^\deff} a_{\vec{q}}\,\alpha_{\vec{q}} \Big ) = \tr~a_{\vec{0}}.
% \end{equation}
% The monomials $\alpha_{\vec{n}}$ are orthonormal with respect to the scalar product induced by the trace
% \begin{equation}
% \langle\alpha_{\vec{n}},\alpha_{\vec{n}'}\rangle := \Tt\big (\alpha_{\vec{n}}^\ast\alpha_{\vec{n}'}\big ) = \delta_{\vec{n},\vec{n}'}, \quad \vec{n},\vec{n}' \in \ZM^\deff,
% \end{equation}
% and $\big (\Aa_\Theta, + , \langle , \rangle \big )$ becomes a Hilbert space on which the elements of the algebra act as
% \begin{equation}
% \pi(a)|a'\rangle = |a a' \rangle, \quad a,a' \in \Aa_\Theta.
% \end{equation}
% If we use the shorthand $|\vec{n} \rangle$ for $|\alpha_{\vec{n}}\rangle$, then it is straightforward to see that this Hilbert space is just $\ell^2(\ZM^\deff)$, the space of square summable sequences labeled by $\ZM^\deff$. Furthermore,
% \begin{equation}\label{Eq:MagTr}
% \pi(\alpha_{\vec{q}})|\vec{n} \rangle = |\alpha_{\vec{q}}\alpha_{\vec{n}} \rangle = e^{2 \pi \imath \langle \vec{q}|\Theta_+|\vec{n}\rangle}|\alpha_{\vec{q} + \vec{n}}\rangle,
% \end{equation}
% where $\Theta_+$ is the upper diagonal part of $\Theta$ (which is $0$ in our case, but it could represent the additional presence of a static, external magnetic field). Eq.~\eqref{Eq:MagTr} is just the magnetic translation by $\vec{q}$ in ordinary tight-binding solid state models, written in the Landau gauge. In this representation, the entries $\Theta_{ij}$ of $\Theta$ correspond to the flux of the magnetic field through the facet $\{i,j\}$ of the primitive cell, expressed in half the quantum of flux unit $h/2e$. 


\subsection{Some general elements of K-theory}

{\it The following section is adapted from \cite{Liu2022}}. The general goal of the K-theory of operator algebras is to supply all independent topological invariants that can be associated to projections and unitary elements of an algebra.
In particular, the $K$-theory group $K_0(\mathcal{A}_\Theta)$ classifies the projections
\begin{equation}
p \in \Mm_\infty \otimes \Aa_\Theta, \quad p^2 = p^\ast=p,
\end{equation}
with respect to the von~Neumann equivalence relation
\begin{equation}\label{Eq-EquivRelation}
p \sim p' \quad \mbox{iff}  \quad p=vv' \ \  {\rm and} \ \ p' = v'v, 
\end{equation}
for some partial isometries $v$ and $v'$ with  $ vv', v'v \in \Mm_\infty \otimes \Aa_\Theta$. 
$\Mm_N$ is the algebra of $N \times N$ matrices with complex entries and $M_\infty$ is the direct limit of these algebras. 
For any $p$ from $\Mm_\infty \otimes \Aa_\Theta$, there exists $N \in \NM$ such that $p \in \Mm_N \otimes \Aa_\Theta$, hence we do not really need to work with infinite matrices. However, $\Mm_N$ can be canonically embedded into $\Mm_\infty$ and this convenient, because it enables $N$ to take flexible values.
There are two further equivalence relations for projections which could be used, and which lead to the same group $K_0(\mathcal{A}_\Theta)$ \cite[p.~18]{Park2008}:
\begin{itemize}
\item  Similarity equivalence:
\begin{equation}
p \sim_u p' \quad {\rm iff} \quad p'= u p u^\ast
\end{equation}
for some unitary element $u$ from $\Mm_\infty \otimes \Aa_\Theta$;
\item Homotopy equivalence:
\begin{equation}
p \sim_h p' \quad  {\rm iff} \quad \bm p(0)=p \ \  {\rm and} \ \  \bm p(1) = p'
\end{equation}
for some continuous function $\bm p : [0,1] \rightarrow \Mm_\infty \otimes \Aa_\Theta$, which always returns a projection. 
\end{itemize}
Homotopy equivalence is the topological equivalence as understood by condensed matter physicists. 
% While the three equivalence relations are different in general, tensoring $\Aa_\Theta$ by $\Mm_\infty$ makes them entirely equivalent. For topological classification, $\sim_h$ is the most interesting relation, but, as we shall see, the relation $\sim$ is essential for understanding the spectral properties of Hamiltonians. 
The equivalence class of a projection $p$ will be denoted by $[p]$, i.e., $[p]$ is the set
\begin{equation}
[p]= \big \{p' \in \Mm_\infty \otimes \Aa_\Theta \, ,  \ p' \sim p \big \}.
\end{equation}
If $p \in \Mm_N \otimes \Aa_\Theta$ and $p' \in \Mm_M \otimes \Aa_\Theta$ are two projections, then $\begin{pmatrix} p & 0 \\ 0 & p' \end{pmatrix}$ is a projection from $\Mm_{N+M} \otimes \Aa_\Theta$ and one can define the addition
\begin{equation}
[p] \oplus [p'] = \left [  \left( \begin{matrix} p & 0 \\ 0 & p' \end{matrix} \right) \right ],
\end{equation}
which provides a semigroup structure on the set of equivalence classes. Then $K_0(\Aa_\Theta)$ is its  enveloping group \cite{Blackadar1998} and, for the noncommutative $\deff$-torus,
\begin{equation}\label{Eq:K0} 
K_0(\Aa_\Theta) = \ZM^{2^{\deff-1}},
\end{equation}
regardless of $\Theta$ and where $\deff = r+d$.
As such, there are $2^{\deff-1}$ generators $[e_J]$, which can be uniquely labeled by the subsets of indices $J \subseteq \{1,\ldots,d\}$ of even cardinality \cite{Prodan2016}. Eq.~\eqref{Eq:K0} assures us that, for any projection $p$ from $\Mm_\infty \otimes \Aa_\Theta$, one has
\begin{equation}\label{Eq-GenExpansion}
[p]  = \sum_{J \subseteq \{1,\ldots,\deff \}}^{|J|={\rm even}} n_J \, [e_J], 
\end{equation} 
where the coefficients $n_J$ are integer numbers that do not change as long as $p$ is deformed inside its $K_0$-class. 
Specifically, two homotopically equivalent projections will display the same coefficients, hence $\{n_J\}_{|J|={\rm even}}$ represent the {\it complete} set of topological invariants associated to the projection $p$. 
Furthermore, two projections that display the same set of coefficients are necessarily in the same $K_0$-class. 
%Let us point out that the coefficient $n_J$ corresponding to $J=\{1,2,\ldots,\deff \}$ is called the top coefficient and is equal to the strong Chern number associated to the projection $p$ \cite[Sec.~5.7]{Prodan2016}.

% \vspace{0.2cm}

% The second group of the complex $K$-theory is $K_1(\Aa_\Theta)$, which classifies the unitary elements
% \begin{equation}
% u \in \Mm_\infty \otimes \Aa_\Theta, \quad u u^\ast = u^\ast u=1,
% \end{equation}
% with respect to the homotopy equivalence relation. The class of $u\in \Mm_\infty \otimes \Aa_\Theta$ will be denoted by $[u]_1$. For the noncommutative $d$-torus,
% \begin{equation}
% K_1(\Aa_\Theta) = \ZM^{2^{\deff-1}},
% \end{equation}
% regardless of $\Theta$. Again, there are $2^{\deff-1}$ generators $[u_J]_1$, which can be uniquely labeled by the subsets of indices $J \subseteq \{1,\ldots,d\}$ of odd cardinality \cite{ProdanSpringer2016}. This assures us that, for any unitary $u$ from $\Mm_\infty \otimes \Aa_\Theta$, one has
% \begin{equation}
% [u]_1  =\sum_{J \subseteq \{1,\ldots,\deff \}}^{|J|={\rm odd}} n_J \, [u_J]_1,
% \end{equation} 
% and the coefficients $n_J$ are again integer numbers that do not change as long as $u$ is deformed inside its class. Specifically, two homotopic unitaries will display the same coefficients, hence $\{n_J\}_{|J|={\rm odd}}$ represent the complete set of topological invariants associated to $u$.  

\subsection{Differential calculus on the noncommutative torus}

As a preliminary step to the calculation of Chern numbers on the noncommutative torus, a differential calculus needs to be established.
Let $\lambda_i \in \CM$, $|\lambda_i| =1$ and observe that commutation relations of $\mathcal{A}_\Theta$ are invariant with respect to:
\begin{equation}
\alpha_j \mapsto \lambda_j \alpha_j.
\end{equation}
As such, we can define a $\deff$-torus action:
\begin{equation}
\TM^\deff \ni \bm \lambda=(\lambda_1,\ldots,\lambda_\deff) \mapsto \rho_{\bm \lambda}: \mathcal{A}_\Theta \to \mathcal{A}_\Theta
\end{equation}
where the latter is the algebra automorphism:
\begin{equation}
	A = \sum_{\vec{q} \in \ZM^{\deff}} a_{\vec{q}}
	\, \alpha_1^{q_1} \ldots\alpha_\deff^{q_\deff}
	\mapsto  
	\sum_{\vec{q} \in \ZM^{\deff}} a_{\vec{q}}
	\, 
	\lambda_1^{q_1} \ldots\lambda_\deff^{q_\deff}
	\alpha_1^{q_1} \ldots\alpha_\deff^{q_\deff} .
\end{equation}
Then the generators of the torus action:
\begin{equation}
\partial_i(A) = i \partial_{\lambda_i} \rho_{\bm \lambda}(A)|_{\bm \lambda \rightarrow 1}
=\sum_{\vec{q} \in \ZM^{\deff}} i q_i a_{\vec{q}}
\, \alpha_1^{q_1} \ldots\alpha_\deff^{q_\deff}
\end{equation}
provide derivations on the noncommutative $\deff$-torus. 
We again define our indices with respect to the index set $\mathcal{I} = \lbrace \tau_1 \cdots, \tau_d, u_1  \cdots, u_r  \rbrace$.
Since
\begin{align}
	\partial_{\phi_k}  e^{2\pi i \boldsymbol{\phi} \cdot \vec{n}} = 2\pi  i n_k  e^{2 \pi i \boldsymbol{\phi} \cdot \vec{n}},
\end{align}
one finds that the $u$-derivations are just given by the partial derivatives
\begin{align}
	\partial_{u_k}  A 
	=  (2\pi)^{-1}\partial_{\phi_k}  A. 
\end{align}
For the $\tau$-derivations, the representation on the Hilbert space evaluates to
\begin{align}
	\pi_{\boldsymbol{\phi}} (\partial_{\tau_k} A) = i [ \hat{X}_k, \pi_{\boldsymbol{\phi}} (A)],
\end{align}
where $\hat{\vec{X}} = \sum_{\vec{q}\in \mathbb{Z}^d} \vec{x}_{\vec{q}}\ket{\vec{q}} \bra{\vec{q}}$ is the position operator on the Hilbert space.


% For an operator $\hat{A} = \pi_{\boldsymbol{\phi}} (A)$, we define the crystal momentum representation
% \begin{equation}
% 	\hat{A}_{\vec{k}} = e^{-i \vec{k} \cdot \hat{\vec{X}}}\hat{A}  e^{i \vec{k} \cdot \hat{\vec{X}}},
% \end{equation}
% and therefore
% \begin{align}
% 	\partial_{k_j} \hat{A}_{\vec{k}} &= -i [ \hat{X}_j, \hat{A}_{\vec{k}}] = -e^{-i \vec{k} \cdot \hat{\vec{X}}} i [ \hat{X}_j, \hat{A}] e^{i \vec{k} \cdot \hat{\vec{X}}}
% 	= - ( \pi_{\boldsymbol{\phi}}(\partial_{\tau_j} A) )_{\vec{k}}
% \notag \\
% \partial_{\phi_j} \hat{A}_{\vec{k}} &= 2 \pi ( \pi_{\boldsymbol{\phi}}(\partial_{u_j} A) )_{\vec{k}}
% \end{align}
% If the multi-$\vec{q}$ texture is commensurate with the lattice, a Bloch basis can be chosen:
% \begin{align}
% 	\psi_{\vec{k} \vec{q} \alpha}(\vec{r}) = \frac{1}{\sqrt{N}}
% 	\sum_{\vec{R}} e^{i \vec{k}\cdot \vec{R}} \phi_{\vec{q},\alpha}(\vec{r}-\vec{R}),
% \end{align}
% where $\vec{R}$ describes the lattice of the superstructure and $\phi_{\vec{q}}$ is the orbital wave function localized at atomic site $\vec{x}_{\vec{q}}$ in the superstructure.
% We introduce the new basis notation for the orbital wave functions
% \begin{equation}
% 	\ket{\vec{R}, \vec{q}, \alpha} = \ket{\vec{R}+\vec{x}_{\vec{q}}, \alpha} ,
% \end{equation}
% where we identify
% \begin{equation}
% 	\braket{\vec{r}, \beta | \vec{R}, \vec{q}, \alpha} = \delta_{\alpha, \beta}~\phi_{\vec{q},\alpha}(\vec{r}-\vec{R}) .
% \end{equation}
% The lattice fourier transform (Wannier basis) is given by:


If the multi-$\vec{q}$ texture is commensurate with the lattice, a Bloch basis can be chosen.
We introduce the new basis notation for the orbital wave functions
\begin{equation}
	\ket{\vec{R}, \vec{q}, \alpha} = \ket{\vec{R}+\vec{x}_{\vec{q}}, \alpha} ,
\end{equation}
here $\vec{R}$ describes the lattice of the superstructure.
The lattice Fourier transform (Wannier basis) is given by:
\begin{equation}
	\ket{\vec{R}, \vec{q}, \alpha} = \frac{1}{\sqrt{N}}
	\sum_{\vec{k} \in \mathrm{1. BZ}} e^{-i \vec{k}\cdot\vec{R}} 
	\ket{\psi_{\vec{k} \vec{q} \alpha}},
\end{equation}
where $N$ is now the number of primitive cells in the system.
Let $\hat{A}$ now represent a translationally invariant operator (w.r.t. the superstructure), i.e.,
\begin{align}
	\hat{A} & = \sum_{\vec{R}, \vec{R}'} \sum_{\vec{q}, \vec{q}' , \alpha, \beta}
	A_{\vec{R}-\vec{R}'}^{ \alpha, \beta, \vec{q}, \vec{q}'} \ket{\vec{R}, \vec{q}, \alpha} \bra{\vec{R}',\vec{q}', \beta}
	\notag \\
	&= \frac{1}{N} \sum_{\vec{k}, \vec{k}' \in \mathrm{1. BZ}}
	\sum_{\vec{R}, \vec{R}'} \sum_{\vec{q}, \vec{q}' , \alpha, \beta}
	A_{\vec{R}-\vec{R}'}^{ \alpha, \beta, \vec{q}, \vec{q}'} 
	e^{-i \vec{k}\cdot\vec{R}} 
	e^{+i \vec{k}'\cdot\vec{R}'} 
	\ket{\psi_{\vec{k} \vec{q} \alpha}} \bra{\psi_{\vec{k}' \vec{q}' \beta}}
	\notag \\
	&=  \sum_{\vec{k}, \vec{k}' \in \mathrm{1. BZ}}
	 \sum_{\vec{q}, \vec{q}' , \alpha, \beta}
	A_{\vec{k}, \vec{k}'}^{ \alpha, \beta, \vec{q}, \vec{q}'} 
	\ket{\psi_{\vec{k} \vec{q} \alpha}} \bra{\psi_{\vec{k}' \vec{q}' \beta}},
\end{align}
where 
\begin{align}
	A_{\vec{k}, \vec{k}'}^{ \alpha, \beta, \vec{q}, \vec{q}'} 
	& =  \frac{1}{N}
	\sum_{\vec{R}, \vec{R}'}A_{\vec{R}-\vec{R}'}^{ \alpha, \beta, \vec{q}, \vec{q}'} 
	e^{-i \vec{k}\cdot\vec{R}} 
	e^{+i \vec{k}'\cdot\vec{R}'} 
	\notag \\
	& =  \frac{1}{N}
	\sum_{\vec{R}, \vec{R}'}A_{\vec{R}}^{ \alpha, \beta, \vec{q}, \vec{q}'} 
	e^{-i \vec{k}\cdot\vec{R}} 
	e^{-i \vec{k}\cdot\vec{R}'} 
	e^{+i \vec{k}'\cdot\vec{R}'} 
	\notag \\
	& =   \delta_{\vec{k}, \vec{k}'}
	\sum_{\vec{R}}A_{\vec{R}}^{ \alpha, \beta, \vec{q}, \vec{q}'} 
	e^{-i \vec{k}\cdot\vec{R}} 
	\notag \\
	& \equiv   \delta_{\vec{k}, \vec{k}'}
	(A_{\vec{k}})_{ \alpha, \beta, \vec{q}, \vec{q}'} .
\end{align}

This means that the trace of any operator product of translationally invariant operators is given by
\begin{align}
\mathcal{T} \left( \hat{A}^1 \cdots  \hat{A}^j \right) &=
\frac{1}{V}
\lim\limits_{N\to \infty}	\frac{1}{N} \sum_{\vec{k} \in \mathrm{1.BZ}} ~ \tr~ A^1_{\vec{k}} \cdots A^j_{\vec{k}}
\notag \\
& =   \int\limits_{\mathrm{1.BZ}}  \frac{\dd^d \vec{k}}{(2\pi)^d}~ \tr~ A^1_{\vec{k}} \cdots A^j_{\vec{k}},
\end{align}
where $V$ is the volume of the primitive unit cell and the trace $\tr$ includes the internal lattice degrees of freedom within the unit cell (in the addition to the spin degree).
Take now a covariant operator
\begin{align}
	\hat{A} &=
	\sum_{\vec{R}} \sum_{\alpha\beta}
	\sum_{\vec{q} }  A_{\alpha,\beta}( \tau_\vec{-q}\boldsymbol{\phi})~ \ket{\vec{R},\vec{q}, \alpha}\bra{\vec{R},\vec{q}, \beta} ,
\end{align}
and therefore
\begin{align}
	(A_{\vec{k}})_{ \alpha, \beta, \vec{q}, \vec{q}'}
	= \delta_{\vec{q}, \vec{q}'} (A_{\vec{k}}( \tau_\vec{-q}\boldsymbol{\phi}))_{ \alpha, \beta} . 
\end{align}
We split the trace in two parts $\tr = \tr_{\vec{q}} \tr_{\sigma} $ according to the atomistic degrees of freedom and the spin degree of freedom. 
By carrying out the operator product of covariant operators, one finds
\begin{align}
	\mathcal{T} \left( \hat{A}^1 \cdots  \hat{A}^j \right) & =   \int\limits_{\mathrm{1.BZ}}\frac{\dd^d \vec{k}}{(2\pi)^d}~ \tr_{\vec{q}} \tr_\sigma ~ A^1_{\vec{k}} \cdots A^j_{\vec{k}}
	\notag \\
	&=
 \sum_{\vec{q}}\int\limits_{\mathrm{1.BZ}} \frac{\dd^d \vec{k}}{(2\pi)^d}~ \tr_\sigma ~ A^1_{\vec{k}}( \tau_\vec{-q}\boldsymbol{\phi})\cdots A^j_{\vec{k}}( \tau_\vec{-q}\boldsymbol{\phi})
	\notag \\
	&  
	\to
	\int\limits_{\mathrm{1.BZ}} \frac{\dd^d \vec{k}}{(2\pi)^d} \int \limits_{\Omega}\dd^r \boldsymbol{\phi}~ \tr_\sigma ~ A^1_{\vec{k}}( \boldsymbol{\phi})\cdots A^j_{\vec{k}}( \boldsymbol{\phi}) .
	\end{align}
Here, the limit $\to$ indicates the transition to a smooth magnetic texture, which is supported by a larger and larger amount of atomic sites in the primitive cell of the superstructure.
As a further ingredient, one needs that the action of the translation operator is ergodic on $\Omega$ in the smooth limit.

Assuming $\hat{A}$ is diagonal in $\vec{q}$ (as is the case for the covariant operators):
\begin{align}
	i [ \hat{X}_i, A]
	& =  \sum_{\vec{R}, \vec{R}'} \sum_{\vec{q} , \alpha, \beta}
	i(\vec{R}-\vec{R}')_i A_{\vec{R}-\vec{R}'}^{ \alpha, \beta, \vec{q}} \ket{\vec{R}, \vec{q}, \alpha} \bra{\vec{R}',\vec{q}, \beta}
	\notag \\
	& =    \sum_{\vec{k} \in \mathrm{1. BZ}} \sum_{\vec{q} , \alpha, \beta}
	\sum_{\vec{R}}   i R_i~ A_{\vec{R}}^{ \alpha, \beta, \vec{q}} 
	e^{-i \vec{k}\cdot\vec{R}} 
	\ket{\psi_{\vec{k} \vec{q} \alpha}} \bra{\psi_{\vec{k} \vec{q} \beta}}
	\notag \\
	& =   -\sum_{\vec{k} \in \mathrm{1. BZ}} \sum_{\vec{q} , \alpha, \beta}\partial_{k_i}
	\sum_{\vec{R}}   A_{\vec{R}}^{ \alpha, \beta, \vec{q}} 
	e^{-i \vec{k}\cdot\vec{R}} 
	\ket{\psi_{\vec{k} \vec{q} \alpha}} \bra{\psi_{\vec{k} \vec{q} \beta}}
	\notag \\
	& =   \sum_{\vec{k} \in \mathrm{1. BZ}}\sum_{\vec{q} , \alpha, \beta}
	(-\partial_{k_i}A_{\vec{k}})_{ \alpha, \beta, \vec{q}}
	\ket{\psi_{\vec{k} \vec{q} \alpha}} \bra{\psi_{\vec{k} \vec{q} \beta}} 
\end{align}
For covariant operators, we therefore have the correspondence dictionary for the covariant Bloch representation
\begin{align}
	\pi_{\boldsymbol{\phi}}(A)
	& \to A_{\vec{k}}(\boldsymbol{\phi})
	\label{eq:rep1}
\\
	\pi_{\boldsymbol{\phi}}(\partial_{u_j} A)
	& 
	\to \partial_{\phi_j} A_{\vec{k}}(\boldsymbol{\phi}) / (2\pi)
	\label{eq:rep2}
	\\
	\pi_{\boldsymbol{\phi}}(\partial_{\tau_j} A)
	& 
	\to -\partial_{k_j} A_{\vec{k}}(\boldsymbol{\phi}) 
	\label{eq:rep3}
\\
 \mathcal{T} & \to  \int\limits_{\mathrm{1.BZ}} \frac{\dd^d \vec{k}}{(2\pi)^d}~ \tr_\sigma ~ \sum_{\vec{q}}\tau_{\vec{q}} \rhd,
\end{align}
where $\tau_{\vec{q}} \rhd$ denotes the action: 
\begin{equation}
	\tau_{\vec{q}} \rhd A^1( \boldsymbol{\phi}) \cdots  A^j( \boldsymbol{\phi}) \equiv A^1( \tau_{-\vec{q}}\boldsymbol{\phi}) \cdots  A^j( \tau_{-\vec{q}}\boldsymbol{\phi})
\end{equation}
And, in the limit of smooth textures and ergodic action,
\begin{align}
	\sum_{\vec{q}}\tau_{\vec{q}} \rhd \to \int\limits_{\Omega }\dd^r \boldsymbol{\phi} .
\end{align}

\subsection{Noncommutative Chern numbers}

Now that the differential calculus on the torus is established, the Chern numbers can be defined.
The Chern number of a projection $P$ to gap $g$ and associated to a subset of indices $J$ of even cardinality is given by
\begin{equation}
	    {\rm Ch}_{J'}(g) = \frac{(2\pi i)^{|J'|/2}}{( |J'|/2 )!} \sum_{\sigma \in \Ss_{|J'|}} (-1)^\sigma \Tt\Big ( P \prod_{j \in J'} \partial_{\sigma_j}P \Big ) ,
\end{equation}
where for $J = \emptyset$, we define ${\rm Ch}_\emptyset(P) = \Tt(P)$.
The structure of the noncommutative torus imposes relations on the Chern numbers.
These can be found by studying the values of the Chern numbers on the $K_0$-generators of $\mathcal{A}_\Theta$, which can be found in \cite{Prodan2016}[p.~141]:
\begin{equation}\label{Eq:ChernValues}
{\rm Ch}_{J'} [E_J]_0 = \left \{ 
\begin{array}{l}
0 \ {\rm if} \ J'\nsubseteq J  , \\
1 \ {\rm if} \ J' = J , \\
{\rm Pf}(\Theta_{J\setminus J'}) \ {\rm if} \ J' \subset J,
\end{array}
\right .  \quad J, J' \subset \{1,\ldots,\deff\}.
\end{equation}
Since the Chern numbers are also linear maps, their values on the gap projection $[P_G]_0 = \sum_{J} n_J \, [e_J]_0$ can be straightforwardly computed from Eq.~\eqref{Eq:ChernValues}:
\begin{equation}\label{Eq:ChernVal}
{\rm Ch}_{J'}(g) = n_{J'}(g) + \sum_{J' \subsetneq J} n_J(g) \, {\rm Pf}(\Theta_{J\setminus J'}).
\end{equation} 
The $K$-theory of the noncommutative torus therefore imposes relations among the various Chern numbers. 
Top Chern number corresponding to $J'=\{1,\ldots,\deff\}$ is always an integer, but the lower Chern numbers may not be.

To illustrate the special case of a commensurate texture, consider the special case of $d=r=2$ and $\deff =d+r=4$.
Via the correspondence dictionary, we find the top Chern number provided by the expression (for $J=\lbrace \tau_1, \tau_2, u_1, u_2 \rbrace $)
\begin{align}
{\rm Ch}_{J}(g)
= -\frac{1}{2}
\int\limits_{\mathrm{1.BZ}} \frac{\dd^d \vec{k}}{(2\pi)^d}~\sum_{\vec{q}}\tau_{\vec{q}} \rhd\sum_{\sigma \in \Ss_{4}} (-1)^\sigma \tr_\sigma ~ 
P_{\vec{k}}(\boldsymbol{\phi}) \prod_{j \in J} \partial_{\sigma_j}P_{\vec{k}}(\boldsymbol{\phi}),
\end{align}
where the representations of Eq.~\ref{eq:rep1} - Eq.~\ref{eq:rep2} have already been inserted.
We identify the Berry curvature 
\begin{equation}
	F_{\sigma_1, \sigma_2}(\vec{k}, \boldsymbol{\phi})
	= i P_{\vec{k}}(\boldsymbol{\phi}) [
	\partial_{\sigma_1} P_{\vec{k}}(\boldsymbol{\phi}), \partial_{\sigma_2} 
	P_{\vec{k}}(\boldsymbol{\phi}) ]
\end{equation}
and write
\begin{align}
\sum_{\sigma \in \Ss_{4}} (-1)^\sigma \tr_\sigma ~ 
P_{\vec{k}}(\boldsymbol{\phi}) \prod_{j \in J} \partial_{\sigma_j}P_{\vec{k}}(\boldsymbol{\phi}) &=
\epsilon^{\alpha\beta\gamma\delta}
\tr_\sigma ~
P_{\vec{k}}(\boldsymbol{\phi}) \partial_{\sigma_\alpha }P_{\vec{k}}(\boldsymbol{\phi})
\partial_{\sigma_\beta }P_{\vec{k}}(\boldsymbol{\phi})
\partial_{\sigma_\gamma }P_{\vec{k}}(\boldsymbol{\phi})
\partial_{\sigma_\delta }P_{\vec{k}}(\boldsymbol{\phi})
\notag \\
&=
\epsilon^{\alpha\beta\gamma\delta}
\tr_\sigma ~
P_{\vec{k}}(\boldsymbol{\phi}) \partial_{\sigma_\alpha }P_{\vec{k}}(\boldsymbol{\phi})
\partial_{\sigma_\beta }P_{\vec{k}}(\boldsymbol{\phi})
P_{\vec{k}}(\boldsymbol{\phi}) 
\partial_{\sigma_\gamma }P_{\vec{k}}(\boldsymbol{\phi})
\partial_{\sigma_\delta }P_{\vec{k}}(\boldsymbol{\phi})
\notag \\
& = - \frac{1}{4}
\epsilon^{\alpha\beta\gamma\delta}
\tr_\sigma ~F_{\alpha \beta}(\vec{k}, \boldsymbol{\phi}) F_{\gamma\delta}(\vec{k}, \boldsymbol{\phi}) .
\end{align}
Inserting this result into the expression for the Chern number gives
\begin{align}
	{\rm Ch}_{J}(g)
	& = \frac{1}{8 }\sum_{\vec{q}}
 \int\limits_{\mathrm{1.BZ}} \frac{\dd^d \vec{k}}{(2\pi)^d}~ \epsilon^{\alpha\beta\gamma\delta}
 \tr_\sigma ~F_{\alpha \beta}(\vec{k}, \tau_{-\vec{q}}\boldsymbol{\phi}) F_{\gamma\delta}(\vec{k}, \tau_{-\vec{q}}\boldsymbol{\phi}) 
 \notag \\
 & = \frac{1}{32 \pi^2}\sum_{\vec{q}}
 \int\limits_{\mathrm{1.BZ}}\dd^d \vec{k} ~ \epsilon^{\alpha\beta\gamma\delta}
 \tr_\sigma ~F_{\alpha \beta}(\vec{k}, \tau_{-\vec{q}}\boldsymbol{\phi}) F_{\gamma\delta}(\vec{k}, \tau_{-\vec{q}}\boldsymbol{\phi}) 
 \notag \\
 & \to \frac{1}{32 \pi^2} \int\limits_{\Omega} \dd^r\boldsymbol{\phi}
 \int\limits_{\mathrm{1.BZ}} \dd^d \vec{k} ~ \epsilon^{\alpha\beta\gamma\delta}
 \tr_\sigma ~F_{\alpha \beta}(\vec{k},\boldsymbol{\phi}) F_{\gamma\delta}(\vec{k}, \boldsymbol{\phi}) 
 \notag \\
 & = \frac{1}{32 \pi^2} \int\limits_{T^{\deff}}  \dd^\deff \boldsymbol{\lambda}
  ~ \epsilon^{\alpha\beta\gamma\delta}
 \tr_\sigma ~F_{\alpha \beta}(\boldsymbol{\lambda}) F_{\gamma\delta}(\boldsymbol{\lambda}) ,
\end{align}
which is the familiar expression for the second Chern number in terms of the Berry curvature~\cite{Qi2008}.
Repeating the same calculation for the case of $d=r=1$ and $\deff =d+r=2$, with $J=\lbrace \tau u \rbrace $, one finds
\begin{align}
	{\rm Ch}_{J}(g)
 & =- \frac{1}{2 \pi}\sum_{\vec{q}}
 \int\limits_{\mathrm{1.BZ}}\dd^d \vec{k} ~
 \tr_\sigma ~F_{\tau u}(\vec{k}, \tau_{-\vec{q}}\boldsymbol{\phi}) 
 \notag \\
 & \to -\frac{1}{2 \pi} \int\limits_{\Omega} \dd^r\boldsymbol{\phi}
 \int\limits_{\mathrm{1.BZ}} \dd^d \vec{k} ~
 \tr_\sigma ~F_{\tau u}(\vec{k},\boldsymbol{\phi}) ) 
 \notag \\
 & = -\frac{1}{2 \pi} \int\limits_{T^{\deff}}  \dd^\deff \boldsymbol{\lambda}
  ~
 \tr_\sigma ~F_{\tau u}(\boldsymbol{\lambda})  ,
\end{align}
which, in this case, is representing the usual expression for the first Chern number in terms of the Berry curvature~\cite{Qi2008}. 


\subsection{The \texorpdfstring{$\Theta$-matrix}{Theta-matrix} for \texorpdfstring{3$\vec{q}$}{3q} states on the triangular lattice}

In this section, we discuss the construction of the skyrmion $3\vec{q}$-state on the triangular lattice as it appears in the manuscript.
Real- and reciprocal space lattice vectors are introduced via
\begin{align}
	\vec{a}_1 &= (1,0)^T
	\\
	\vec{a}_2 &= (1/2,\sqrt{3}/2 )^T
	\\
	\vec{b}_1 &= 2 \pi (1, -1/\sqrt{3})^T
	\\
	\vec{b}_2 &= 2 \pi (0, 2 / \sqrt{3})^T .
\end{align}
With respect to these lattice vectors, the $\vec{q}$-vectors of the texture are given by
\begin{align}
	\vec{q_1} &= \theta_1 \vec{b}_2 \\
	\vec{q_2} &= \theta_1\vec{b}_1 \\ 
	\vec{q_3} &= \theta_1(-\vec{b}_1- \vec{b_2}) 
\end{align}
One can confirm that these vectors form the vertices of an equilateral triangle and that $\sum_i \vec{q}_i = 0$.
From the definition follows that the $\theta$-matrix is given by
\begin{equation}
	\theta =
	\theta_1 
	\begin{pmatrix}
		0 & 1 \\
		1 & 0 \\
		-1 & -1
	\end{pmatrix} .
\end{equation}
As initial phases we take $\boldsymbol{\phi} = (0,0,\pi)$.  
The respective Chern number decomposition can be found in table \ref{tab:3q_2d} at the end of this document (the analogous case for a 2$\vec{q}$-state in $d=1$ and $d=2$ is shown in \ref{tab:2q_1d} and  \ref{tab:2q_2d} respectively).
Let $R^z_{2\pi/3}$ represent a $-2\pi/3$ rotation around the $z$-axis.
Then we write
\begin{align}
	\hatn_\mathrm{SkX}(\vec{x}) &=  \sum_{i=1}^{3 } (R^z_{2\pi/3})^{i-1} \hatn_\mathrm{hx} ( ((R^z_{2\pi/3})^{i-1} \vec{q}_1 )\cdot \vec{x}/ (2\pi) + \phi_i ) 
	\\
	\hatn_\mathrm{XY-V}(\vec{x}) &= \sum_{i=1}^{3 } (R^z_{2\pi/3})^{i-1} \hatn_\mathrm{sdw} ( ((R^z_{2\pi/3})^{i-1} \vec{q}_1 )\cdot \vec{x}/ (2\pi)  + \phi_i ) .
\end{align}
Here, the skyrmion lattice $\hatn_\mathrm{SkX}$ is therefore constructed from a coherent superposition of three spin helices (hx), and the vortex lattice $\hatn_\mathrm{XY-V}$ is constructed  from a coherent superposition of spin density waves (sdw).
Respectively, these are defined by
\begin{align}
\hatn_\mathrm{hx} (\psi) &=  (0, \sin(\psi), \cos(\psi))^T,
\\
\hatn_\mathrm{sdw} (\psi) &=  (\sin(\psi),0,0)^T .
\end{align}
For the SkX is state, the result of the formula is always normalized by
$\hatn_\mathrm{SkX}(\vec{x}) \to \hatn_\mathrm{SkX}(\vec{x}) / \| \hatn_\mathrm{SkX}(\vec{x})\| $, while for the $XY-V$ state, one scales the result such that
\begin{equation}
	\sup_\vec{x} \| 	\hatn_\mathrm{XY-V}(\vec{x}) \| = 1.
\end{equation}	
As the exact diagonalization of the Hamiltonian is computationally more demanding in $d=2$ dimensions compared to the $d=1$ case, we combine the spectra of different linear system sizes $N\in[19, 79]$ (i.e. there are $N$ lattice unit cells per dimension).
The $\theta_1$ are sampled again at rational values $\theta_1 = m /N $ with $m \in \mathbb{Z}$ and $ 0\leq m \leq N$.
Since $N$ is not necessarily prime, some $\theta_1$-values would be sampled multiple times.
When this occurs for two different values of $N$, we always choose the larger system size to obtain a better spectral resolution. 




% \subsection{old paragraph from paper}

% Noncommutative K-theory classifies the projection operators which can arise from this observable algebra.
% In particular, the $K_0$ group is given by $K_0(\mathcal{A}) = \mathbb{Z}^{2^{r+d-1}}$, which means that any class of topologically equivalent projection operators $[P]$ can be written as a linear combination of generators $[P] =\sum_J n_J [E_J]$, conveniently labelled by even cardinality subsets $J$ of $\mathcal{I}=\lbrace \tau_1 \cdots, \tau_d, u_1  \cdots, u_r \rbrace$.
% The coefficients $n_J$ are necessarily integers, and constitute the full topological characterization of $[P]$~\cite{Prodan2016a}.
% For a gap projection $g$ on the noncommutative torus, 
% this characterization can be achieved by a computation of the Chern numbers
% $ {\rm Ch}_{J'}$ labelled by $J' \subseteq \mathcal{I}
% $~\cite{Prodan2016a}, i.e.,
% \begin{equation}
%    {\rm Ch}_{J'} (g) =  \sum_{J \subseteq \mathcal{I} }^{|J|~\mathrm{even}}  n_J(g) \, {\rm Ch}_{J'}(E_J),
%    \label{eq:chern_expansion}
% \end{equation}
% where ${\rm Ch}_{J'}(E_J)=1$ if $J=J'$,  ${\rm Ch}_{J'}(E_J)=0$ if $J \not\subseteq J'$ and ${\rm Ch}_{J'}(E_J) = \mathrm{Pf}( \Theta_{J\setminus J'})$ otherwise.
% The operation $\mathrm{Pf}$ denotes the Pfaffian and $\Theta_{J\setminus J'}$ denotes the representation of $\Theta$ in the reduced index set $J\setminus J'$.
% We focus on the zeroth Chern number $ {\rm Ch}_{\emptyset}$, which is nothing but the integrated density of states (IDS)~\cite{Apigo2018}:
% \begin{equation}
%     {\rm Ch}_{\emptyset}(g) = \mathrm{IDS}(g) = \lim\limits_{N\to\infty}  \frac{1}{N} \tr~P_{E<E_g},
%     \label{eq:ids_sum}
% \end{equation}
% where $N$ is the number of lattice sites, $E_g$ is an energy in the gap $g$ and $P_{E<E_g}$ is the projector onto the states below $E_g$.
% In the following, we use the IDS, to map out the possible Chern numbers which can be realized from the Hamiltonian in Eq.~(\ref{eq:hamiltonian}).
% As suggested by Eq.~(\ref{eq:chern_expansion}), multi-$\vec{q}$ magnetism can generate a finite $\Theta$-matrix, and thereby faciliate the emergence of topologically nontrivial electronic states. 



\subsection{Discussion of the relation to emergent magnetic fields}

In the adiabatic limit of smooth textures and strong exchange coupling, our theory should reduce to the well-known language of emergent magnetic fields.
To discuss the adiabatic limit, we introduce the unitary transformation
\begin{equation}
	U^\dagger(\vec{x}) ( \hatn(\vec{x})\cdot \bsigma ) U(\vec{x})  = \sigma_z .
\end{equation}
By parameterizing the magnetization vector in polar coordinates $\hatn = \hatn(\theta, \phi)$ in spherical coordinates, this transformation can be formulated explicitly as $\mathcal{U} = \hatn(\theta/2, \phi)\cdot \bsigma \equiv \vec{m} \cdot \bsigma$.
The discretization on the lattice is given by
\begin{equation}
	U( \hat{\vec{x}}) = \sum_{\vec{k} \in \mathbb{Z}^d} U( \vec{x}_{\vec{k}} )\ket{\vec{k}} \bra{\vec{k}} .
\end{equation}
Applying the transformation to the Hamiltonian, one finds
\begin{align}
	U( \hat{\vec{x}})^\dagger H  U( \hat{\vec{x}}) = \sum_{\braket{\vec{k},\vec{l}} \in \mathbb{Z}^{2d}} t_{\vec{k}\vec{l}} \ket{\vec{k}}\bra{\vec{l}}
	+ \xc\sum_{\vec{k} \in \mathbb{Z}^d}  \sigma_z ~ \ket{\vec{k}}\bra{\vec{k}} ,
	\label{eq:hamiltonian}
\end{align}
where $t_{\vec{k}\vec{l}} = t U^\dagger(\vec{x}_\vec{k}) U(\vec{x}_\vec{l})$.
In the limit $\xc / t \to \infty$, one can project onto the eigenstates $\sigma = \pm 1$ of $\sigma_z$ in order to arrive at the effective Hamiltonian
\begin{equation}
	H_\mathrm{eff}^\sigma
	= \sum_{\braket{\vec{k},\vec{l}} \in \mathbb{Z}^{2d}} t_{\vec{k}\vec{l}, \sigma}^{\mathrm{eff}} \ket{\vec{k}}\bra{\vec{l}},
\end{equation}
where
$
t_{\vec{k}\vec{l}, \sigma}^{\mathrm{eff}} =t  \braket{\sigma |  U^\dagger(\vec{x}_\vec{k}) U(\vec{x}_\vec{l})  | \sigma }
$.
In the continuous case, a vector potential can be defined as
$
A_i = - i \hbar U^\dagger \partial_i U  / e ,
$
which has the adiabatic projection
\begin{equation}
	A_i^{\pm} = \pm \frac{\hbar}{e} ( \vec{m} \times \partial_i \vec{m} )_z .
\end{equation}
From this, one obtains the emergent magnetic field
\begin{equation}
	B_z^\pm 
	= (\nabla \times \vec{A}^\pm)_z = \pm \frac{\hbar}{2 e} \hatn \cdot (\partial_x \hatn \times \partial_y \hatn) .
\end{equation}
For an isolated skyrmion of topological charge 
\begin{equation}
	\mathcal{Q} = \frac{1}{4 \pi}\int\limits_{\mathbb{R}^2} \dd \vec{x}~ \hatn \cdot (\partial_x \hatn \times \partial_y \hatn) \in \mathbb{Z}
\end{equation}
is quantized.
The emergent flux in this case is
\begin{equation}
	\Phi^\pm = \int\limits_{\mathbb{R}^2} \dd \vec{x}~ B_z^\pm 
	=\pm \frac{\hbar}{2 e} \int\limits_{\mathbb{R}^2} \dd \vec{x}~ \hatn \cdot (\partial_x \hatn \times \partial_y \hatn)
	=\pm 2 \pi \frac{\hbar}{ e}  \mathcal{Q} .
\end{equation}


%\subsubsection*{Transformed translation operator in two dimensions}

{\bf Transformed translation operator in two dimensions}. 
Applying the translation operator to the previously defined unitary operator, we find
\begin{align}
	\hat{T}_\vec{m} U( \hat{\vec{x}}) \hat{T}_\vec{m}^\dagger
	& = \sum_{\vec{k}} U(\vec{x}_\vec{k}) \ket{\vec{k}+\vec{m}} \bra{\vec{k}+\vec{m}}
	\notag \\
	& = \sum_{\vec{k}} U( \vec{x}_{\vec{k}- \vec{m}} ) \ket{\vec{k}} \bra{\vec{k}}
	\notag \\
	& = U( \hat{\vec{x}} - \vec{x}_\vec{m}),
\end{align}
from which one can obtain the relation
$\hat{T}_\vec{m} U( \hat{\vec{x}}) = U( \hat{\vec{x}} - \vec{x}_\vec{m}) \hat{T}_\vec{m}$.
Within the changed frame of reference, the new unit translation operator is given by
\begin{align}
	\hat{S}_i &\equiv U^\dagger ( \hat{\vec{x}}) \hat{T}_i U ( \hat{\vec{x}})
	\notag \\ &=
	U^\dagger ( \hat{\vec{x}}) U( \hat{\vec{x}} - \vec{a}_i) \hat{T}_i  .
\end{align}
We now assume that $\hatn$ is given by a multi-$\vec{q}$ state in $d=2$ dimensions, characterized by a single pitch variable $\theta_1$.
For a smoothly varying texture (limit of small $\theta_1$), the pre-factor can be expanded:
\begin{align}
	U^\dagger ( \vec{x}) U( \vec{x} - \vec{a}_i) 
	& = \id_2
	- U^\dagger ( \vec{x})( \vec{a}_i \cdot \nabla) U( \vec{x} ) + \mathcal{O}(\theta_1^2)
	\notag \\
	& = \id_2
	+ i  e~\vec{a}_i  \cdot \vec{A} / \hbar + \mathcal{O}(\theta_1^2)
	\notag \\
	& = \id_2
	+ \frac{i e}{\hbar} \int\limits_{\vec{x}}^{\vec{x}+\vec{a}_i} \dd\vec{r}~\vec{A}  + \mathcal{O}(\theta_1^2) 
	\notag \\
	& = \exp\left( \frac{i e}{\hbar} \int\limits_{\vec{x}}^{\vec{x}+\vec{a}_i} \dd\vec{r}~\vec{A} \right) + \mathcal{O}(\theta_1^2) ,
\end{align}
were we have implicitly used the adiabatic projection into a spin-subspace.
Introduce the shorthand notation
\begin{align}
	\uparrow_{\vec{x}}^{\vec{x}+\vec{a} } &\equiv \exp\left( \frac{i e}{\hbar} \int\limits_{\vec{x}}^{\vec{x}+\vec{a}_i} \dd\vec{r}~\vec{A} \right) ,
	\\
	\downarrow_{\vec{x}}^{\vec{x}+\vec{a} } &\equiv \exp\left( -\frac{i e}{\hbar} \int\limits_{\vec{x}}^{\vec{x}+\vec{a}_i} \dd\vec{r}~\vec{A} \right) .
\end{align}
Using this notation, one can derive the commutation relations
\begin{align}
	S_1 S_2 &=
	\uparrow_{\vec{x}}^{\vec{x}+\vec{a}_1 } T_1 \uparrow_{\vec{x}}^{\vec{x}+\vec{a}_2 } T_2 
	\notag \\
	&=
	\uparrow_{\vec{x}}^{\vec{x}+\vec{a}_1 } \uparrow_{\vec{x}-\vec{a}_1}^{\vec{x}+\vec{a}_2 -\vec{a}_1} T_2  T_1
	\notag \\
	&=
	\uparrow_{\vec{x}}^{\vec{x}+\vec{a}_1 } \uparrow_{\vec{x}-\vec{a}_1}^{\vec{x}+\vec{a}_2 -\vec{a}_1} T_2 \downarrow_{\vec{x}}^{\vec{x}+\vec{a}_1 } S_1
	\notag \\
	&=
	\uparrow_{\vec{x}}^{\vec{x}+\vec{a}_1 } \uparrow_{\vec{x}-\vec{a}_1}^{\vec{x}+\vec{a}_2 -\vec{a}_1} \downarrow_{\vec{x}+\vec{a}_2}^{\vec{x}+\vec{a}_1+\vec{a}_2 }T_2  S_1
	\notag \\
	&=
	\uparrow_{\vec{x}}^{\vec{x}+\vec{a}_1 } \uparrow_{\vec{x}-\vec{a}_1}^{\vec{x}+\vec{a}_2 -\vec{a}_1} \downarrow_{\vec{x}+\vec{a}_2}^{\vec{x}+\vec{a}_1+\vec{a}_2 }
	\downarrow_{\vec{x}}^{\vec{x}+\vec{a}_2 }
	S_2  S_1 .
\end{align}
Since
\begin{equation}
	\uparrow_{\vec{x}-\vec{a}_1}^{\vec{x}+\vec{a}_2 -\vec{a}_1}
	=
	\uparrow_{\vec{x}+\vec{a}_1}^{\vec{x}+\vec{a}_2 +\vec{a}_1} + \mathcal{O}(\theta_1^2),
\end{equation}
the combination of integrals amounts to clockwise line integral around the unit cell  anchored at $\vec{x}$.
We change this to a counter-clockwise orientation and apply the Stokes theorem to write the emergent flux as
\begin{equation}
	\Phi(\vec{x}) = \oint\limits_{\partial \mathrm{uc}(\vec{x})} \dd\vec{r}\cdot \vec{A} = \int\limits_{\mathrm{uc}(\vec{x})} \dd^2\vec{r}~ (\nabla \times \vec{A})_z .
\end{equation}              
We therefore find the commutation relation
\begin{equation}
	S_1 S_2 = e^{-i\hbar \Phi(\vec{x})/ e} S_2 S_1 + \mathcal{O}(\theta_1^2).
\end{equation}    
For the lattice of skyrmions with charge $\mathcal{Q}=1$, the emergent flux per magnetic unit cell is quantized, i.e., it is given by
$ | e\Phi_\mathrm{sk}/\hbar | = 2 \pi $.
On average, the flux per unit cell of the lattice is therefore given by
\begin{equation}
	\Braket{\Phi(\vec{x})}  =	\frac{2 \pi}{ \Braket{N_\mathrm{uc}}},
\end{equation}
where $\Braket{N_\mathrm{uc}}$ is the average number of lattice unit cells within a magnetic unit cell.
In $d=2$ dimensions, one has $\Braket{N_\mathrm{uc}} = 1 / \theta_1^2$
The algebra can then be approximated by replacing the exact flux $\Phi(\vec{x})$ per lattice unit cell by this average and one obtains the commutation relation
\begin{equation}
	S_1 S_2 \approx e^{-i 2\pi \theta_1^2} S_2 S_1 ,
\end{equation}
while at same time, $S_i$ commutes with the Fourier factors since the non-collinear magnetism has been transformed away.
All possible Chern numbers are then summarized by the table
\begin{align}
	\begin{tabular}{L|L}
		J' & \mathrm{Ch}_{J'} \\ \toprule
		\{\} & \theta _1^2 n_{\left\{s_1,s_2\right\}}+n_{\{\}} \\
		\left\{s_1,s_2\right\} & n_{\left\{s_1,s_2\right\}} 
	\end{tabular}
\end{align}
Consequently, the IDS in the gap $g$ for the effective system is given by the expansion
\begin{equation}
	\mathrm{IDS}(g) = n_\emptyset(g) + n_{s_1, s_2}(g) \theta_1^2 .
\end{equation}
By matching the coefficients, of the two limits one therefore finds
\begin{equation}
	n_{\lbrace s_1, s_2 \rbrace}(g) \sim n_{t^2 u^2}(g) , ~\text{for}~ | \xc / t| \to \infty .
\end{equation}
Further, the left-hand side can also be calculated directly as Chern number, since
\begin{equation}
	\mathrm{Ch}_{\lbrace s_1, s_2 \rbrace}(g) = n_{\lbrace s_1, s_2 \rbrace}(g) .
\end{equation}
Since the Chern number is invariant under unitary transformations of the Hamiltonian, this then leads to
\begin{equation}
	\mathrm{Ch}_{\lbrace t_1, t_2 \rbrace}(g) \sim \mathrm{Ch}_{\lbrace s_1, s_2 \rbrace}(g)\sim n_{t^2 u^2}(g) , ~\text{for}~ | \xc / t| \to \infty ,
\end{equation}
which means that the presence of a quantum anomalous Hall effect can be deduced from the IDS (where $n_{t^2 u^2}(g)$ can be extracted).
To rephrase this result: the relation holds, because we have shown that the physics of the asymptotic limit is described by a $2$-dimensional subalgebra of the full $(2+r)$-dimensional noncommutative torus generated by $	\hat{S}_i = \braket{\sigma |
U^\dagger ( \hat{\vec{x}}) U( \hat{\vec{x}} - \vec{a}_i) | \sigma } \hat{T}_i $.
This subalgebra is completely characterized by two topological integers $n_{\lbrace \rbrace}$ and $n_{\lbrace s_1, s_2 \rbrace}$ which can be directly extracted from the IDS.

% This statement can also be understood from a more general consideration, which involves the Fourier decomposition for a general magnetic texture. 
% The previous analysis has shown, that a new translation operator $\hat{S}_i$ can be defined as a twisted version of the original translation operator $\hat{T}_i$. 
% We may write the relation between $\hat{S}_i$ and $\hat{T}_i$ as 
% \begin{equation}
% 	\hat{S}_i = W_i(\hat{\vec{x}})  \hat{T}_i ,
% \end{equation}
% where the operator $W_i$ has the periodicity of the multi-$\vec{q}$ texture.
% In the asymptotic limit of $| \xc / t| \to \infty$, one can consider $W_i(\vec{x}) \in \mathbb{C}$ after a projection into the respective spin subspace.
% It follows, that the new commutation relation can be expressed as 
% \begin{equation}
% 	\hat{S}_1 \hat{S}_2 = F(\hat{\vec{x}})  \hat{S}_2 \hat{S}_1, 
% 	~~ F(\hat{\vec{x}}) = \frac{W_2(  \hat{\vec{x}}  )}{W_1(  \hat{\vec{x}}  )}
% 	\frac{W_1(  \hat{\vec{x}} - \vec{a}_2  )}{W_2(  \hat{\vec{x}}- \vec{a}_1  )} .
% \end{equation}
% When the texture is slowly varying, the Fourier series expansion of $F(\hat{\vec{x}})$ is dominated by the first term (the constant one). This constant is precisely the factor 
% $e^{-i 2\pi \theta_1^2}$ which was previously derived.





\subsection{The \texorpdfstring{$\Theta$}{Theta}-matrix on the cubic hedgehog lattice}

In the case of the cubic hedgehog lattice, one deals with three linearly independent, mutually orthogonal $\vec{q}$-vectors: $\vec{q}_i = q\vec{e}_i$.
This means that the $\theta$-matrix is just the identity in $d=3$ dimensions: $\theta = \theta_1 \id_3$. 
Table \ref{tab:3q_3d} summarizes the possible Chern numbers in this case.
Noteworthy is the emergence of a third Chern numbers in the IDS:
\begin{equation}
	\mathrm{IDS}(g)
	=
	n_\emptyset
	+ n_{\tau u} \theta_1 
	+ n_{\tau^2 u^2} \theta_1^2
	+ n_{\tau^3 u^3} \theta_1^3,
\end{equation}
where 
\begin{align}
n_{\tau u}  
& = n_{\lbrace \tau_1 u_1 \rbrace}  + n_{\lbrace \tau_2 u_2 \rbrace} + n_{\lbrace \tau_3 u_3 \rbrace} 
\\
n_{\tau^2 u^2}  
& = n_{\lbrace \tau_1 \tau_2 u_1 u_2 \rbrace}  
+ n_{\lbrace \tau_1 \tau_3 u_1 u_3 \rbrace}   
+ n_{\lbrace \tau_2 \tau_3 u_2 u_3 \rbrace}   
\\
n_{\tau^3 u^3}  
& = n_{\lbrace \tau_1 \tau_2 \tau_3 u_1 u_2 u_3 \rbrace}.
\end{align}
The latter can be identified with the top-level Chern number
\begin{equation}
	\mathrm{Ch}_{\lbrace \tau_1 \tau_2 \tau_3 u_1 u_2 u_3 \rbrace}
	=
	n_{\lbrace \tau_1 \tau_2 \tau_3 u_1 u_2 u_3 \rbrace}.
\end{equation} 

%-- literature ------------------------------------

\hbadness=99999 
\bibliographystyle{apsrev4-2}
\bibliography{literature}

\clearpage


\begin{table}[t]
	\begin{tabular}{L|L}
		J' & \mathrm{Ch}_{J'} \\ \toprule
 \{\} & \theta _1 n_{\left\{\tau _1,u_1\right\}}+\theta _2 n_{\left\{\tau _1,u_2\right\}}+n_{\{\}} \\
\left\{\tau _1,u_1\right\} & n_{\left\{\tau _1,u_1\right\}} \\
\left\{\tau _1,u_2\right\} & n_{\left\{\tau _1,u_2\right\}} \\
\left\{u_1,u_2\right\} & n_{\left\{u_1,u_2\right\}} 
	\end{tabular}
\caption{Chern number expansion for a 2$\vec{q}$-state in $d=1$ dimensions with $\theta = (\theta_1, \theta_2)^T$ (e.g. the 2-$\vec{q}$ helicoids)
}
\label{tab:2q_1d}
\end{table}

	\begin{table}[t]
\begin{tabular}{L|L}
	J' & \mathrm{Ch}_{J'} \\ \toprule
	\{\} & \theta _1^2 n_{\left\{\tau _1,\tau _2,u_1,u_2\right\}}+\theta _1 n_{\left\{\tau _1,u_2\right\}}+\theta _1 n_{\left\{\tau _2,u_1\right\}}+n_{\{\}} \\
	\left\{\tau _1,\tau _2\right\} & n_{\left\{\tau _1,\tau _2\right\}} \\
	\left\{\tau _1,u_1\right\} & n_{\left\{\tau _1,u_1\right\}} \\
	\left\{\tau _1,u_2\right\} & \theta _1 n_{\left\{\tau _2,u_1\right\}}+\theta _1 n_{\left\{\tau _1,\tau _2,u_1,u_2\right\}}+n_{\left\{\tau _1,u_2\right\}} \\
	\left\{\tau _2,u_1\right\} & \theta _1 n_{\left\{\tau _1,u_2\right\}}+\theta _1 n_{\left\{\tau _1,\tau _2,u_1,u_2\right\}}+n_{\left\{\tau _2,u_1\right\}} \\
	\left\{\tau _2,u_2\right\} & n_{\left\{\tau _2,u_2\right\}} \\
	\left\{u_1,u_2\right\} & n_{\left\{u_1,u_2\right\}} \\
	\left\{\tau _1,\tau _2,u_1,u_2\right\} & n_{\left\{\tau _1,\tau _2,u_1,u_2\right\}}
\end{tabular}
\caption{Chern number expansion for a 2$\vec{q}$-state in $d=2$ dimensions with $\theta = \theta_1 ((0,1),(1,0))$ (an example would be the 2-$\vec{q}$ skyrmion lattice).
}
\label{tab:2q_2d}
\end{table}


\begin{turnpage}
	\begin{table}
	\begin{tabular}{L|L}
		J' & \mathrm{Ch}_{J'} \\ \toprule
		 \{\} & \theta _1^2 n_{\left\{\tau _1,\tau _2,u_1,u_2\right\}}+\theta _1^2 n_{\left\{\tau
			_1,\tau _2,u_1,u_3\right\}}+\theta _1^2 n_{\left\{\tau _1,\tau
			_2,u_2,u_3\right\}}+\theta _1 n_{\left\{\tau _1,u_2\right\}}+\theta _1 n_{\left\{\tau
			_1,u_3\right\}}+\theta _1 n_{\left\{\tau _2,u_1\right\}}+\theta _1 n_{\left\{\tau
			_2,u_3\right\}}+n_{\{\}} \\
		\left\{\tau _1,\tau _2\right\} & n_{\left\{\tau _1,\tau _2\right\}} \\
		\left\{\tau _1,u_1\right\} & \theta _1 n_{\left\{\tau _2,u_3\right\}}+\theta _1
		n_{\left\{\tau _1,\tau _2,u_1,u_3\right\}}+n_{\left\{\tau _1,u_1\right\}} \\
		\left\{\tau _1,u_2\right\} & \theta _1 n_{\left\{\tau _2,u_1\right\}}+\theta _1
		n_{\left\{\tau _2,u_3\right\}}+\theta _1 n_{\left\{\tau _1,\tau
			_2,u_1,u_2\right\}}+\theta _1 n_{\left\{\tau _1,\tau
			_2,u_2,u_3\right\}}+n_{\left\{\tau _1,u_2\right\}} \\
		\left\{\tau _1,u_3\right\} & \theta _1 n_{\left\{\tau _2,u_1\right\}}+\theta _1
		n_{\left\{\tau _1,\tau _2,u_1,u_3\right\}}+n_{\left\{\tau _1,u_3\right\}} \\
		\left\{\tau _2,u_1\right\} & \theta _1 n_{\left\{\tau _1,u_2\right\}}+\theta _1
		n_{\left\{\tau _1,u_3\right\}}+\theta _1 n_{\left\{\tau _1,\tau
			_2,u_1,u_2\right\}}+\theta _1 n_{\left\{\tau _1,\tau
			_2,u_1,u_3\right\}}+n_{\left\{\tau _2,u_1\right\}} \\
		\left\{\tau _2,u_2\right\} & \theta _1 n_{\left\{\tau _1,u_3\right\}}+\theta _1
		n_{\left\{\tau _1,\tau _2,u_2,u_3\right\}}+n_{\left\{\tau _2,u_2\right\}} \\
		\left\{\tau _2,u_3\right\} & \theta _1 n_{\left\{\tau _1,u_2\right\}}+\theta _1
		n_{\left\{\tau _1,\tau _2,u_2,u_3\right\}}+n_{\left\{\tau _2,u_3\right\}} \\
		\left\{u_1,u_2\right\} & \theta _1 n_{\left\{\tau _1,u_3\right\}}+\theta _1
		n_{\left\{\tau _2,u_3\right\}}+\theta _1 n_{\left\{\tau _1,u_1,u_2,u_3\right\}}+\theta
		_1 n_{\left\{\tau _2,u_1,u_2,u_3\right\}}+n_{\left\{u_1,u_2\right\}} \\
		\left\{u_1,u_3\right\} & \theta _1 n_{\left\{\tau _1,u_2\right\}}+\theta _1
		n_{\left\{\tau _1,u_1,u_2,u_3\right\}}+n_{\left\{u_1,u_3\right\}} \\
		\left\{u_2,u_3\right\} & \theta _1 n_{\left\{\tau _2,u_1\right\}}+\theta _1
		n_{\left\{\tau _2,u_1,u_2,u_3\right\}}+n_{\left\{u_2,u_3\right\}} \\
		\left\{\tau _1,\tau _2,u_1,u_2\right\} & n_{\left\{\tau _1,\tau _2,u_1,u_2\right\}} \\
		\left\{\tau _1,\tau _2,u_1,u_3\right\} & n_{\left\{\tau _1,\tau _2,u_1,u_3\right\}} \\
		\left\{\tau _1,\tau _2,u_2,u_3\right\} & n_{\left\{\tau _1,\tau _2,u_2,u_3\right\}} \\
		\left\{\tau _1,u_1,u_2,u_3\right\} & n_{\left\{\tau _1,u_1,u_2,u_3\right\}} \\
		\left\{\tau _2,u_1,u_2,u_3\right\} & n_{\left\{\tau _2,u_1,u_2,u_3\right\}}
	\end{tabular}
	\caption{Chern number expansion for $ \theta = \theta_1 (( 
		0, 1),
		(  1,0 ),
		( -1,-1 )) $ (the 3-$\vec{q}$, triangular skyrmion lattice).}
	\label{tab:3q_2d}
	\end{table}
\end{turnpage}


\begin{turnpage}
	\begin{table}
		\scalebox{0.8}{
	\begin{tabular}{L|L}
		J' & \mathrm{Ch}_{J'} \\ \toprule
\{\} & \theta _1^3 n_{\left\{\tau _1,\tau _2,\tau _3,u_1,u_2,u_3\right\}}+\theta _1^2
n_{\left\{\tau _1,\tau _2,u_1,u_2\right\}}+\theta _1^2 n_{\left\{\tau _1,\tau
	_3,u_1,u_3\right\}}+\theta _1^2 n_{\left\{\tau _2,\tau _3,u_2,u_3\right\}}+\theta _1
n_{\left\{\tau _1,u_1\right\}}+\theta _1 n_{\left\{\tau _2,u_2\right\}}+\theta _1
n_{\left\{\tau _3,u_3\right\}}+n_{\{\}} \\
\left\{\tau _1,\tau _2\right\} & \theta _1 n_{\left\{\tau _3,u_3\right\}}+\theta _1
n_{\left\{\tau _1,\tau _2,\tau _3,u_3\right\}}+n_{\left\{\tau _1,\tau _2\right\}} \\
\left\{\tau _1,\tau _3\right\} & \theta _1 n_{\left\{\tau _2,u_2\right\}}+\theta _1
n_{\left\{\tau _1,\tau _2,\tau _3,u_2\right\}}+n_{\left\{\tau _1,\tau _3\right\}} \\
\left\{\tau _1,u_1\right\} & \theta _1^2 n_{\left\{\tau _2,\tau
	_3,u_2,u_3\right\}}+\theta _1^2 n_{\left\{\tau _1,\tau _2,\tau
	_3,u_1,u_2,u_3\right\}}+\theta _1 n_{\left\{\tau _2,u_2\right\}}+\theta _1
n_{\left\{\tau _3,u_3\right\}}+\theta _1 n_{\left\{\tau _1,\tau
	_2,u_1,u_2\right\}}+\theta _1 n_{\left\{\tau _1,\tau
	_3,u_1,u_3\right\}}+n_{\left\{\tau _1,u_1\right\}} \\
\left\{\tau _1,u_2\right\} & \theta _1 n_{\left\{\tau _3,u_3\right\}}+\theta _1
n_{\left\{\tau _1,\tau _3,u_2,u_3\right\}}+n_{\left\{\tau _1,u_2\right\}} \\
\left\{\tau _1,u_3\right\} & \theta _1 n_{\left\{\tau _2,u_2\right\}}+\theta _1
n_{\left\{\tau _1,\tau _2,u_2,u_3\right\}}+n_{\left\{\tau _1,u_3\right\}} \\
\left\{\tau _2,\tau _3\right\} & \theta _1 n_{\left\{\tau _1,u_1\right\}}+\theta _1
n_{\left\{\tau _1,\tau _2,\tau _3,u_1\right\}}+n_{\left\{\tau _2,\tau _3\right\}} \\
\left\{\tau _2,u_1\right\} & \theta _1 n_{\left\{\tau _3,u_3\right\}}+\theta _1
n_{\left\{\tau _2,\tau _3,u_1,u_3\right\}}+n_{\left\{\tau _2,u_1\right\}} \\
\left\{\tau _2,u_2\right\} & \theta _1^2 n_{\left\{\tau _1,\tau
	_3,u_1,u_3\right\}}+\theta _1^2 n_{\left\{\tau _1,\tau _2,\tau
	_3,u_1,u_2,u_3\right\}}+\theta _1 n_{\left\{\tau _1,u_1\right\}}+\theta _1
n_{\left\{\tau _3,u_3\right\}}+\theta _1 n_{\left\{\tau _1,\tau
	_2,u_1,u_2\right\}}+\theta _1 n_{\left\{\tau _2,\tau
	_3,u_2,u_3\right\}}+n_{\left\{\tau _2,u_2\right\}} \\
\left\{\tau _2,u_3\right\} & \theta _1 n_{\left\{\tau _1,u_1\right\}}+\theta _1
n_{\left\{\tau _1,\tau _2,u_1,u_3\right\}}+n_{\left\{\tau _2,u_3\right\}} \\
\left\{\tau _3,u_1\right\} & \theta _1 n_{\left\{\tau _2,u_2\right\}}+\theta _1
n_{\left\{\tau _2,\tau _3,u_1,u_2\right\}}+n_{\left\{\tau _3,u_1\right\}} \\
\left\{\tau _3,u_2\right\} & \theta _1 n_{\left\{\tau _1,u_1\right\}}+\theta _1
n_{\left\{\tau _1,\tau _3,u_1,u_2\right\}}+n_{\left\{\tau _3,u_2\right\}} \\
\left\{\tau _3,u_3\right\} & \theta _1^2 n_{\left\{\tau _1,\tau
	_2,u_1,u_2\right\}}+\theta _1^2 n_{\left\{\tau _1,\tau _2,\tau
	_3,u_1,u_2,u_3\right\}}+\theta _1 n_{\left\{\tau _1,u_1\right\}}+\theta _1
n_{\left\{\tau _2,u_2\right\}}+\theta _1 n_{\left\{\tau _1,\tau
	_3,u_1,u_3\right\}}+\theta _1 n_{\left\{\tau _2,\tau
	_3,u_2,u_3\right\}}+n_{\left\{\tau _3,u_3\right\}} \\
\left\{u_1,u_2\right\} & \theta _1 n_{\left\{\tau _3,u_3\right\}}+\theta _1
n_{\left\{\tau _3,u_1,u_2,u_3\right\}}+n_{\left\{u_1,u_2\right\}} \\
\left\{u_1,u_3\right\} & \theta _1 n_{\left\{\tau _2,u_2\right\}}+\theta _1
n_{\left\{\tau _2,u_1,u_2,u_3\right\}}+n_{\left\{u_1,u_3\right\}} \\
\left\{u_2,u_3\right\} & \theta _1 n_{\left\{\tau _1,u_1\right\}}+\theta _1
n_{\left\{\tau _1,u_1,u_2,u_3\right\}}+n_{\left\{u_2,u_3\right\}} \\
\left\{\tau _1,\tau _2,\tau _3,u_1\right\} & n_{\left\{\tau _1,\tau _2,\tau
	_3,u_1\right\}} \\
\left\{\tau _1,\tau _2,\tau _3,u_2\right\} & n_{\left\{\tau _1,\tau _2,\tau
	_3,u_2\right\}} \\
\left\{\tau _1,\tau _2,\tau _3,u_3\right\} & n_{\left\{\tau _1,\tau _2,\tau
	_3,u_3\right\}} \\
\left\{\tau _1,\tau _2,u_1,u_2\right\} & \theta _1 n_{\left\{\tau _3,u_3\right\}}+\theta
_1 n_{\left\{\tau _1,\tau _2,\tau _3,u_3\right\}}+\theta _1 n_{\left\{\tau _1,\tau
	_3,u_1,u_3\right\}}+\theta _1 n_{\left\{\tau _1,\tau _3,u_2,u_3\right\}}+\theta _1
n_{\left\{\tau _2,\tau _3,u_1,u_3\right\}}+\theta _1 n_{\left\{\tau _2,\tau
	_3,u_2,u_3\right\}}+\theta _1 n_{\left\{\tau _3,u_1,u_2,u_3\right\}}+\theta _1
n_{\left\{\tau _1,\tau _2,\tau _3,u_1,u_2,u_3\right\}}+n_{\left\{\tau _1,\tau
	_2,u_1,u_2\right\}} \\
\left\{\tau _1,\tau _2,u_1,u_3\right\} & n_{\left\{\tau _1,\tau _2,u_1,u_3\right\}} \\
\left\{\tau _1,\tau _2,u_2,u_3\right\} & n_{\left\{\tau _1,\tau _2,u_2,u_3\right\}} \\
\left\{\tau _1,\tau _3,u_1,u_2\right\} & n_{\left\{\tau _1,\tau _3,u_1,u_2\right\}} \\
\left\{\tau _1,\tau _3,u_1,u_3\right\} & \theta _1 n_{\left\{\tau _2,u_2\right\}}+\theta
_1 n_{\left\{\tau _1,\tau _2,\tau _3,u_2\right\}}+\theta _1 n_{\left\{\tau _1,\tau
	_2,u_1,u_2\right\}}+\theta _1 n_{\left\{\tau _1,\tau _2,u_2,u_3\right\}}+\theta _1
n_{\left\{\tau _2,\tau _3,u_1,u_2\right\}}+\theta _1 n_{\left\{\tau _2,\tau
	_3,u_2,u_3\right\}}+\theta _1 n_{\left\{\tau _2,u_1,u_2,u_3\right\}}+\theta _1
n_{\left\{\tau _1,\tau _2,\tau _3,u_1,u_2,u_3\right\}}+n_{\left\{\tau _1,\tau
	_3,u_1,u_3\right\}} \\
\left\{\tau _1,\tau _3,u_2,u_3\right\} & n_{\left\{\tau _1,\tau _3,u_2,u_3\right\}} \\
\left\{\tau _1,u_1,u_2,u_3\right\} & n_{\left\{\tau _1,u_1,u_2,u_3\right\}} \\
\left\{\tau _2,\tau _3,u_1,u_2\right\} & n_{\left\{\tau _2,\tau _3,u_1,u_2\right\}} \\
\left\{\tau _2,\tau _3,u_1,u_3\right\} & n_{\left\{\tau _2,\tau _3,u_1,u_3\right\}} \\
\left\{\tau _2,\tau _3,u_2,u_3\right\} & \theta _1 n_{\left\{\tau _1,u_1\right\}}+\theta
_1 n_{\left\{\tau _1,\tau _2,\tau _3,u_1\right\}}+\theta _1 n_{\left\{\tau _1,\tau
	_2,u_1,u_2\right\}}+\theta _1 n_{\left\{\tau _1,\tau _2,u_1,u_3\right\}}+\theta _1
n_{\left\{\tau _1,\tau _3,u_1,u_2\right\}}+\theta _1 n_{\left\{\tau _1,\tau
	_3,u_1,u_3\right\}}+\theta _1 n_{\left\{\tau _1,u_1,u_2,u_3\right\}}+\theta _1
n_{\left\{\tau _1,\tau _2,\tau _3,u_1,u_2,u_3\right\}}+n_{\left\{\tau _2,\tau
	_3,u_2,u_3\right\}} \\
\left\{\tau _2,u_1,u_2,u_3\right\} & n_{\left\{\tau _2,u_1,u_2,u_3\right\}} \\
\left\{\tau _3,u_1,u_2,u_3\right\} & n_{\left\{\tau _3,u_1,u_2,u_3\right\}} \\
\left\{\tau _1,\tau _2,\tau _3,u_1,u_2,u_3\right\} & n_{\left\{\tau _1,\tau _2,\tau
	_3,u_1,u_2,u_3\right\}} 
\end{tabular}}
\caption{Chern number expansion for the 3-$\vec{q}$ cubic hedgehog lattice in three dimensions with $\theta = \theta_1 \id_3$.}
\label{tab:3q_3d}
\end{table}
\end{turnpage}
\vfill

\newpage




\end{document}

